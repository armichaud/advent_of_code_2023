Solved parts 1 & 2

Solution 2 just follows the map for each part. Solution uses ranges, which are split and add a new item to the stack whenever there's a partial range match.