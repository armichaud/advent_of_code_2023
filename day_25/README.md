Gave this a shot with brute force, but it's too slow. Didn't have time to revisit this.